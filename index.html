<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Proposal Pendanaan Akhir</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Icons (Phosphor Icons for clean look, loaded via script for usage in HTML) -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #f8fafc; /* Slate 50 - Warm/Cool Neutral Mix */
        color: #334155; /* Slate 700 */
      }

      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #f1f1f1;
      }
      ::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #94a3b8;
      }

      /* Chart Container Styling - Mandatory per requirements */
      .chart-container {
        position: relative;
        width: 100%;
        max-width: 500px; /* Constraints chart width */
        margin-left: auto;
        margin-right: auto;
        height: 300px;
        max-height: 350px;
      }

      .chart-container-large {
        position: relative;
        width: 100%;
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
        height: 350px;
        max-height: 400px;
      }

      /* Card Hover Effects */
      .interactive-card {
        transition: all 0.3s ease;
        border: 1px solid transparent;
      }
      .interactive-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05);
        border-color: #e2e8f0;
      }

      .active-tab {
        border-bottom: 2px solid #0f766e; /* Teal 700 */
        color: #0f766e;
        font-weight: 600;
      }
      .inactive-tab {
        color: #64748b;
        font-weight: 400;
      }
      .inactive-tab:hover {
        color: #334155;
      }
    </style>

    <!-- Placeholder Comments Required -->
    <!-- Chosen Palette: Slate & Teal. Background: #F8FAFC (Slate 50), Primary: #0F766E (Teal 700), Secondary: #F1F5F9 (Slate 100). chosen for a professional, calm, and trustworthy financial proposal tone. -->

    <!-- Application Structure Plan:
        The app is designed as a focused Proposal Dashboard.
        1. **Header/Hero**: Clearly states the intent (Final Funding) and duration (3 Months).
        2. **Executive Summary**: High-level numbers immediately visible.
        3. **Interactive Navigation**: Tabs to switch between "Analisa Biaya" (Cost Breakdown), "Alasan & Strategi" (Justification), and "Rencana Termin" (Payment Plan). This prevents information overload.
        4. **Cost Breakdown Section**: 
           - Donut Chart for category distribution (Visualizing where money goes).
           - Detailed Cards for specific line items (Living, Transport, Setup) with logic to toggle 'Details'.
        5. **Payment Plan Section**: A comparison toggle between 1-Termin and 2-Termin payments, visualizing cash flow needs.
        6. **Justification Section**: Text-heavy but structured grid explaining the 'Why' (Productivity, Research, Safety).
        Flow: User sees total -> explores why it costs that much -> sees payment options -> understands the value proposition.
    -->

    <!-- Visualization & Content Choices:
        1. **Total Budget**: Large Text KPI. Goal: Immediate clarity.
        2. **Cost Distribution**: Chart.js Donut Chart. Goal: Show balance between assets (motor) and consumables (living). Interaction: Click legend to filter.
        3. **Monthly Burn Rate**: Chart.js Bar Chart. Goal: Show that Month 1 is heavy (assets) while Month 2-3 are lean. Justifies the upfront cost.
        4. **Detailed List**: HTML Grid with Icons. Goal: Humanize the costs (e.g., 'Kasur' vs just 'Equipment').
        5. **Termin Toggle**: JS-driven UI. Goal: Allow the sponsor (brother) to choose a payment method that fits their liquidity.
        6. **Library**: Chart.js used for robustness and standard financial visualization.
    -->

    <!-- CONFIRMATION: NO SVG graphics used (only font icons). NO Mermaid JS used. -->
  </head>
  <body class="bg-slate-50 min-h-screen flex flex-col">
    <!-- Navbar / Header -->
    <header
      class="bg-white border-b border-slate-200 sticky top-0 z-30 shadow-sm"
    >
      <div
        class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between"
      >
        <div class="flex items-center gap-2">
          <i class="ph ph-student text-2xl text-teal-700"></i>
          <h1 class="font-bold text-lg text-slate-800 tracking-tight">
            Proposal Last Financial Help
          </h1>
        </div>
        <div class="text-sm font-medium text-slate-500 hidden sm:block">
          Periode: 3 Bulan Depan
        </div>
      </div>
    </header>

    <main class="flex-grow max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">
      <!-- Intro Section -->
      <div class="mb-8">
        <h2 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-2">
          Halo, Mas Tia :).
        </h2>
        <p class="text-slate-600 max-w-2xl leading-relaxed">
          Mas tia ini adalah proposal untuk sampeyan membiayai aku terakhir
          kali, aku buat web biar sampeyan enak bacanya. setelah 3 bulan ini
          insyaallah sampeyan bakal kehilangan 1 beban dalam hidup dan
          insyaallah aku akan bantu sampeyan kedepannya (tapi tunggu sekitar 1
          tahunan dulu ya mas biar stable dulu financialku). Semoga dengan ini
          sampeyan bisa ngasih yang terbaik dan untuk itu terakhir pembiayaan
          ini aku harap sampeyan ga keberatan dan semoga dimudahkan semuanya
        </p>
      </div>

      <!-- KPI Cards -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
        <div
          class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 flex flex-col justify-between"
        >
          <div>
            <p class="text-sm font-medium text-slate-500 mb-1">
              Total Estimasi Biaya
            </p>
            <h3
              class="text-3xl font-bold text-teal-700"
              id="total-cost-display"
            >
              Rp 0
            </h3>
          </div>
          <div
            class="mt-4 flex items-center text-xs text-teal-600 bg-teal-50 w-fit px-2 py-1 rounded"
          >
            <i class="ph ph-check-circle mr-1"></i> Mencakup Aset & Hidup
          </div>
        </div>

        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
          <p class="text-sm font-medium text-slate-500 mb-1">Fokus Alokasi</p>
          <div class="space-y-2 mt-2">
            <div class="flex justify-between text-sm">
              <span class="text-slate-600">Aset (Motor & Setup)</span>
              <span class="font-semibold text-slate-800">42%</span>
            </div>
            <div class="w-full bg-slate-100 rounded-full h-1.5">
              <div
                class="bg-teal-600 h-1.5 rounded-full"
                style="width: 42%"
              ></div>
            </div>
            <div class="flex justify-between text-sm mt-2">
              <span class="text-slate-600">Operasional (3 Bln)</span>
              <span class="font-semibold text-slate-800">58%</span>
            </div>
            <div class="w-full bg-slate-100 rounded-full h-1.5">
              <div
                class="bg-blue-400 h-1.5 rounded-full"
                style="width: 58%"
              ></div>
            </div>
          </div>
        </div>

        <div
          class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 flex flex-col justify-between"
        >
          <div>
            <p class="text-sm font-medium text-slate-500 mb-1">Tujuan Utama</p>
            <p class="text-slate-800 font-medium text-lg leading-snug">
              Pembiayaan hidup Bagas terakhir
            </p>
          </div>
          <p class="text-xs text-slate-400 mt-2">
            Lokasi: Luar Jawa (Kota Besar)
          </p>
        </div>
      </div>

      <!-- Interactive Tabs -->
      <div class="border-b border-slate-200 mb-6">
        <nav class="-mb-px flex space-x-8" aria-label="Tabs">
          <button
            onclick="switchTab('breakdown')"
            id="tab-breakdown"
            class="active-tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"
          >
            Rincian Biaya
          </button>
          <button
            onclick="switchTab('justification')"
            id="tab-justification"
            class="inactive-tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"
          >
            Alasan & Strategi
          </button>
          <button
            onclick="switchTab('payment')"
            id="tab-payment"
            class="inactive-tab whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"
          >
            Opsi Termin Pembayaran
          </button>
        </nav>
      </div>

      <!-- CONTENT SECTION: Rincian Biaya -->
      <div id="content-breakdown" class="space-y-6 animate-fade-in">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
          <!-- Left: Interactive Breakdown List -->
          <div class="lg:col-span-2 space-y-4">
            <div
              class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden"
            >
              <div
                class="p-4 bg-slate-50 border-b border-slate-100 flex justify-between items-center"
              >
                <h3 class="font-semibold text-slate-800">Item Pengeluaran</h3>
                <span
                  class="text-xs text-slate-500 bg-white border border-slate-200 px-2 py-1 rounded-full"
                  >Mode Hemat Diaktifkan</span
                >
              </div>

              <!-- List Container -->
              <div id="cost-list" class="divide-y divide-slate-100">
                <!-- Populated by JS -->
              </div>
            </div>

            <!-- Narrative Context -->
            <div
              class="bg-blue-50 border border-blue-100 rounded-lg p-4 flex gap-3"
            >
              <i class="ph ph-info text-blue-600 text-xl mt-0.5"></i>
              <div>
                <h4 class="text-sm font-semibold text-blue-800">
                  Catatan Penghematan
                </h4>
                <p class="text-sm text-blue-700 mt-1">
                  Kendaraan dialihkan ke <strong>Motor Bekas</strong> untuk
                  menekan biaya aset. Biaya makan ditekan dengan asumsi masak
                  sendiri atau katering hemat, namun tetap menjaga nutrisi.
                </p>
              </div>
            </div>
          </div>

          <!-- Right: Chart Visualization -->
          <div class="lg:col-span-1">
            <div
              class="bg-white rounded-xl shadow-sm border border-slate-100 p-6 sticky top-24"
            >
              <h3 class="font-semibold text-slate-800 mb-4 text-center">
                Proporsi Penggunaan Dana
              </h3>

              <!-- Chart Container -->
              <div class="chart-container">
                <canvas id="costDistributionChart"></canvas>
              </div>

              <div class="mt-6 space-y-3">
                <div class="text-center">
                  <p class="text-xs text-slate-500">
                    Klik pada kategori di chart untuk menyembunyikan/menampilkan
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- CONTENT SECTION: Alasan & Strategi -->
      <div id="content-justification" class="hidden space-y-6">
        <p class="text-slate-600 mb-4">
          Bagian ini menjelaskan rasionalisasi di balik setiap pos biaya.
          Ditujukan agar target pembiayaan hidup 3 bulan aman.
        </p>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Card 1: Kos -->
          <div class="interactive-card bg-white p-6 rounded-xl">
            <div class="flex items-center gap-3 mb-3">
              <div class="p-2 bg-purple-100 text-purple-600 rounded-lg">
                <i class="ph ph-house-line text-xl"></i>
              </div>
              <h3 class="font-semibold text-slate-800">Tempat Tinggal (Kos)</h3>
            </div>
            <p class="text-sm text-slate-600 mb-3">
              <strong>Budget: 1 Juta/bulan.</strong>
              Di lokasi luar Jawa, harga ini mendapatkan kamar standar yang aman
              dan tenang.
            </p>
            <ul class="text-sm text-slate-500 list-disc list-inside space-y-1">
              <li>Fokus: Ketenangan untuk istirahat berkualitas.</li>
              <li>
                Keuntungan : Merasa nyaman dan dapat memberikan semangat untuk
                produktif.
              </li>
              <li>Termasuk: Listrik & Air (estimasi).</li>
            </ul>
          </div>

          <!-- Card 2: Kendaraan -->
          <div class="interactive-card bg-white p-6 rounded-xl">
            <div class="flex items-center gap-3 mb-3">
              <div class="p-2 bg-orange-100 text-orange-600 rounded-lg">
                <i class="ph ph-moped text-xl"></i>
              </div>
              <h3 class="font-semibold text-slate-800">
                Transportasi (Motor Bekas)
              </h3>
            </div>
            <p class="text-sm text-slate-600 mb-3">
              <strong>Pembelian Unit Bekas.</strong>
              Lebih hemat daripada sewa harian/bulanan selama 3 bulan atau naik
              ojek online setiap hari untuk mobilitas ke kantor.
            </p>
            <ul class="text-sm text-slate-500 list-disc list-inside space-y-1">
              <li>Mobilitas tinggi untuk pengambilan data.</li>
              <li>
                Nilai jual kembali (resale value) masih ada setelah 3 bulan.
              </li>
              <li>Efisiensi waktu perjalanan.</li>
            </ul>
          </div>

          <!-- Card 3: Setup Awal -->
          <div class="interactive-card bg-white p-6 rounded-xl">
            <div class="flex items-center gap-3 mb-3">
              <div class="p-2 bg-teal-100 text-teal-600 rounded-lg">
                <i class="ph ph-basket text-xl"></i>
              </div>
              <h3 class="font-semibold text-slate-800">Setup Awal Kos</h3>
            </div>
            <p class="text-sm text-slate-600 mb-3">
              Hanya membeli perlengkapan esensial yang higienis dan mendukung
              fungsi, asumsi kamar sudah
              <em>fully furnished</em> (Kasur/Lemari).
            </p>
            <div class="flex gap-2 flex-wrap">
              <span
                class="px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded"
                >Seprai/Bantal</span
              >
              <span
                class="px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded"
                >Alat Makan</span
              >
              <span
                class="px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded"
                >Alat Mandi</span
              >
            </div>
          </div>

          <!-- Card 4: Biaya Tak Terduga -->
          <div class="interactive-card bg-white p-6 rounded-xl">
            <div class="flex items-center gap-3 mb-3">
              <div class="p-2 bg-red-100 text-red-600 rounded-lg">
                <i class="ph ph-shield-warning text-xl"></i>
              </div>
              <h3 class="font-semibold text-slate-800">Dana Darurat</h3>
            </div>
            <p class="text-sm text-slate-600">
              Dana cadangan untuk kesehatan ringan, kerusakan kendaraan
              mendadak, atau keperluan tak terduga.
            </p>
          </div>
        </div>
      </div>

      <!-- CONTENT SECTION: Rencana Termin -->
      <div id="content-payment" class="hidden space-y-8">
        <!-- Intro for this section -->
        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
          <h3 class="text-lg font-semibold text-slate-800 mb-2">
            Simulasi Cashflow
          </h3>
          <p class="text-slate-600 text-sm mb-6">
            Mengingat total biaya yang cukup besar di awal (karena pembelian
            motor dan tiket), berikut adalah dua opsi pencairan dana yang bisa
            disesuaikan.
          </p>

          <!-- Toggle Controls -->
          <div class="flex justify-center mb-8">
            <div class="bg-slate-100 p-1 rounded-lg inline-flex">
              <button
                onclick="updatePaymentScenario(1)"
                id="btn-termin-1"
                class="px-4 py-2 rounded-md text-sm font-medium bg-white text-slate-800 shadow-sm transition-all"
              >
                1 Kali Pencairan (Full)
              </button>
              <button
                onclick="updatePaymentScenario(2)"
                id="btn-termin-2"
                class="px-4 py-2 rounded-md text-sm font-medium text-slate-500 hover:text-slate-700 transition-all"
              >
                2 Kali Termin (Bertahap)
              </button>
            </div>
          </div>

          <!-- Comparison Chart -->
          <div class="chart-container-large">
            <canvas id="paymentFlowChart"></canvas>
          </div>
        </div>

        <!-- Detailed Breakdown of Selected Scenario -->
        <div id="payment-details" class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Dynamically populated by JS -->
        </div>
      </div>
    </main>

    <footer class="bg-white border-t border-slate-200 mt-auto py-8">
      <div class="max-w-5xl mx-auto px-4 text-center">
        <p class="text-slate-500 text-sm">
          Terima kasih banyak atas dukungannya, Mas Tia.
        </p>
        <p class="text-slate-400 text-xs mt-2">
          Dibuat dengan penuh perhitungan untuk keberhasilan studi.
        </p>
      </div>
    </footer>

    <!-- LOGIC SCRIPT -->
    <script>
      // --- DATA MODEL ---
      const budgetData = {
        items: [
          {
            id: 1,
            category: "Tempat Tinggal",
            name: "Biaya Kos (3 Bulan)",
            detail: "Rp 1.000.000 x 3 bulan. Termasuk listrik/air standar.",
            cost: 3000000,
            icon: "ph-house",
          },
          {
            id: 2,
            category: "Konsumsi",
            name: "Biaya Makan (Hemat)",
            detail: "Rp 50.000/hari x 90 hari. Masak sendiri/warteg.",
            cost: 4500000,
            icon: "ph-bowl-food",
          },
          {
            id: 3,
            category: "Transportasi",
            name: "Tiket Pesawat (1x Jalan)",
            detail: "Ke lokasi Penempatan (Luar Jawa) + Bagasi.",
            cost: 1800000,
            icon: "ph-airplane-tilt",
          },
          {
            id: 4,
            category: "Aset Kendaraan",
            name: "Beli Motor Bekas",
            detail:
              "Motor matic tahun tua tapi prima (e.g., Beat/Mio). Dijual kembali nanti.",
            cost: 10000000,
            icon: "ph-motorcycle",
          },
          {
            id: 5,
            category: "Setup Awal",
            name: "Perlengkapan Kos",
            detail: "Seprai, ember, gayung, alat kebersihan, magic com kecil.",
            cost: 600000,
            icon: "ph-shopping-bag",
          },
          {
            id: 6,
            category: "Cadangan",
            name: "Biaya Tak Terduga",
            detail: "Obat-obatan, servis motor awal, print laporan.",
            cost: 1500000,
            icon: "ph-piggy-bank",
          },
        ],
      };

      // Calculate Totals
      const totalCost = budgetData.items.reduce(
        (acc, item) => acc + item.cost,
        0
      );

      // Termin Scenarios
      const paymentScenarios = {
        1: {
          title: "Opsi 1: Pembayaran Penuh",
          description:
            "Dana ditransfer sekaligus di awal. Memudahkan manajemen aset langsung.",
          schedule: [
            {
              date: "Minggu Depan (Awal)",
              amount: totalCost,
              note: "Untuk beli tiket, motor, bayar kos 3 bulan, dan pegangan.",
            },
          ],
        },
        2: {
          title: "Opsi 2: Pembayaran Bertahap (50:50)",
          description: "Meringankan beban cashflow pengirim.",
          schedule: [
            {
              date: "Tahap 1 (Sekarang)",
              amount: 9000000,
              note: "Prioritas: Tiket, Motor, Kos Bulan 1, Setup Awal.",
            },
            {
              date: "Tahap 2 (Bulan Depan)",
              amount: totalCost - 9000000,
              note: "Sisa biaya hidup dan kos bulan selanjutnya.",
            },
          ],
        },
      };

      // --- UI FORMATTING ---
      const formatIDR = (num) => {
        return new Intl.NumberFormat("id-ID", {
          style: "currency",
          currency: "IDR",
          maximumFractionDigits: 0,
        }).format(num);
      };

      // --- INITIALIZATION ---
      document.addEventListener("DOMContentLoaded", () => {
        // Update Header Totals
        document.getElementById("total-cost-display").textContent =
          formatIDR(totalCost);

        // Render Cost List
        renderCostList();

        // Render Charts
        initCharts();

        // Init Default Termin View
        updatePaymentScenario(1);
      });

      // --- RENDERING FUNCTIONS ---
      function renderCostList() {
        const listContainer = document.getElementById("cost-list");
        listContainer.innerHTML = "";

        budgetData.items.forEach((item) => {
          const row = document.createElement("div");
          row.className =
            "p-4 flex flex-col sm:flex-row sm:items-center justify-between gap-2 hover:bg-slate-50 transition-colors cursor-default group";

          row.innerHTML = `
                    <div class="flex items-start gap-3">
                        <div class="mt-1 p-2 bg-slate-100 rounded text-slate-500 group-hover:text-teal-600 group-hover:bg-teal-50 transition-colors">
                            <i class="ph ${item.icon} text-lg"></i>
                        </div>
                        <div>
                            <h4 class="text-sm font-semibold text-slate-800">${
                              item.name
                            }</h4>
                            <p class="text-xs text-slate-500 mt-0.5">${
                              item.detail
                            }</p>
                        </div>
                    </div>
                    <div class="text-right pl-11 sm:pl-0">
                        <span class="block font-bold text-slate-700 text-sm">${formatIDR(
                          item.cost
                        )}</span>
                        <span class="block text-xs text-slate-400 uppercase tracking-wider">${
                          item.category
                        }</span>
                    </div>
                `;
          listContainer.appendChild(row);
        });
      }

      // --- CHART VARIABLES & LOGIC ---
      let donutChart;
      let flowChart;

      function initCharts() {
        // 1. Donut Chart: Cost Distribution
        const ctxDonut = document
          .getElementById("costDistributionChart")
          .getContext("2d");

        // Group data for chart (simplify categories)
        const categories = {};
        budgetData.items.forEach((item) => {
          if (!categories[item.category]) categories[item.category] = 0;
          categories[item.category] += item.cost;
        });

        donutChart = new Chart(ctxDonut, {
          type: "doughnut",
          data: {
            labels: Object.keys(categories),
            datasets: [
              {
                data: Object.values(categories),
                backgroundColor: [
                  "#0F766E", // Teal 700 (Tempat Tinggal)
                  "#14B8A6", // Teal 500 (Konsumsi)
                  "#0EA5E9", // Sky 500 (Transport)
                  "#F97316", // Orange 500 (Aset Motor)
                  "#64748B", // Slate 500 (Setup)
                  "#EF4444", // Red 500 (Cadangan)
                ],
                borderWidth: 0,
                hoverOffset: 4,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                position: "bottom",
                labels: {
                  usePointStyle: true,
                  padding: 20,
                  font: { family: "Inter", size: 11 },
                },
              },
              tooltip: {
                callbacks: {
                  label: function (context) {
                    return " " + context.label + ": " + formatIDR(context.raw);
                  },
                },
                backgroundColor: "#1e293b",
                padding: 12,
                cornerRadius: 8,
              },
            },
            cutout: "70%",
          },
        });

        // 2. Bar Chart: Payment Flow (Initialized empty, updated by scenario)
        const ctxFlow = document
          .getElementById("paymentFlowChart")
          .getContext("2d");
        flowChart = new Chart(ctxFlow, {
          type: "bar",
          data: { labels: [], datasets: [] },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: {
                beginAtZero: true,
                grid: { borderDash: [2, 4], color: "#e2e8f0" },
                ticks: {
                  callback: function (value) {
                    return value / 1000000 + " Jt";
                  },
                  font: { family: "Inter" },
                },
              },
              x: {
                grid: { display: false },
                ticks: { font: { family: "Inter" } },
              },
            },
            plugins: {
              legend: { display: false },
              tooltip: {
                callbacks: {
                  label: function (context) {
                    return " Nominal: " + formatIDR(context.raw);
                  },
                },
              },
            },
          },
        });
      }

      // --- INTERACTION LOGIC ---

      // Tab Switching
      window.switchTab = function (tabName) {
        // Hide all contents
        ["breakdown", "justification", "payment"].forEach((t) => {
          document.getElementById(`content-${t}`).classList.add("hidden");
          document.getElementById(`tab-${t}`).classList.remove("active-tab");
          document.getElementById(`tab-${t}`).classList.add("inactive-tab");
        });

        // Show selected
        document
          .getElementById(`content-${tabName}`)
          .classList.remove("hidden");
        document.getElementById(`tab-${tabName}`).classList.add("active-tab");
        document
          .getElementById(`tab-${tabName}`)
          .classList.remove("inactive-tab");
      };

      // Payment Scenario Logic
      window.updatePaymentScenario = function (scenarioId) {
        // Update Buttons
        const btn1 = document.getElementById("btn-termin-1");
        const btn2 = document.getElementById("btn-termin-2");

        if (scenarioId === 1) {
          btn1.className =
            "px-4 py-2 rounded-md text-sm font-medium bg-teal-600 text-white shadow-md transition-all";
          btn2.className =
            "px-4 py-2 rounded-md text-sm font-medium text-slate-500 hover:text-slate-700 transition-all";
        } else {
          btn2.className =
            "px-4 py-2 rounded-md text-sm font-medium bg-teal-600 text-white shadow-md transition-all";
          btn1.className =
            "px-4 py-2 rounded-md text-sm font-medium text-slate-500 hover:text-slate-700 transition-all";
        }

        // Update Data
        const data = paymentScenarios[scenarioId];
        const detailContainer = document.getElementById("payment-details");
        detailContainer.innerHTML = "";

        // Render Cards for Schedule
        data.schedule.forEach((item, index) => {
          const card = document.createElement("div");
          card.className =
            "bg-white border border-slate-200 p-4 rounded-lg shadow-sm border-l-4 border-l-teal-500";
          card.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <span class="text-xs font-bold text-teal-600 uppercase tracking-wider">Pembayaran ${
                          index + 1
                        }</span>
                        <span class="text-xs text-slate-400">${item.date}</span>
                    </div>
                    <div class="text-xl font-bold text-slate-800 mb-2">${formatIDR(
                      item.amount
                    )}</div>
                    <p class="text-sm text-slate-600 leading-snug">${
                      item.note
                    }</p>
                `;
          detailContainer.appendChild(card);
        });

        // Update Chart
        flowChart.data.labels = data.schedule.map((s) => s.date);
        flowChart.data.datasets = [
          {
            label: "Nominal Transfer",
            data: data.schedule.map((s) => s.amount),
            backgroundColor:
              scenarioId === 1 ? "#0F766E" : ["#0F766E", "#5EEAD4"],
            borderRadius: 4,
            barPercentage: 0.6,
          },
        ];
        flowChart.update();
      };
    </script>
  </body>
</html>
